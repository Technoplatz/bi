{
  "properties": {
    "ord_no": {
      "bsonType": "string",
      "title": "Order No",
      "description": "Order Number",
      "minLength": 10,
      "maxLength": 10,
      "pattern": "^[0-9-]{10,10}$"
    },
    "ord_prd_no": {
      "bsonType": "string",
      "title": "Product ID",
      "description": "Product ID",
      "minLength": 7,
      "maxLength": 16,
      "pattern": "^[A-Z0-9-]{7,16}$",
      "replacement": [
        {
          "find": "-",
          "replace": ""
        },
        {
          "find": "_",
          "replace": ""
        }
      ]
    },
    "ord_unit_price": {
      "bsonType": "number",
      "title": "Unit Price",
      "description": "Unit Price",
      "default": 0
    }
  },
  "required": ["ord_no", "ord_prd_no", "ord_unit_price"],
  "index": [["ord_no"], ["ord_no", "ord_prd_no"]],
  "unique": [["ord_no", "ord_prd_no"]],
  "sort": {
    "_modified_at": -1
  },
  "parents": [],
  "actions": [],
  "triggers": [
    {
      "name": "Order price updater",
      "enabled": true,
      "operations": ["update", "insert"],
      "changes": [
        {
          "key": "ord_unit_price",
          "op": "gt",
          "value": 0
        }
      ],
      "targets": [
        {
          "collection": "delivery",
          "match": [
            {
              "key": "dnn_order_no",
              "value": "ord_no"
            },
            {
              "key": "dnn_prd_no",
              "value": "ord_prd_no"
            }
          ],
          "filter": [],
          "set": [
            {
              "key": "dnn_order_price",
              "value": "ord_unit_price"
            }
          ],
          "upsert": false
        }
      ]
    }
  ],
  "views": {},
  "links": [],
  "fetchers": []
}
