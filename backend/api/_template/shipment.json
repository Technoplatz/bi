{
  "properties": {
    "shp_date": {
      "bsonType": "date",
      "title": "Date",
      "description": "Shipment Date",
      "width": 140
    },
    "shp_id": {
      "bsonType": "number",
      "title": "ID",
      "description": "Shipment ID",
      "placeholder": "Shipment ID",
      "minimum": 1,
      "maximum": 99999,
      "counter": true,
      "disabled": true,
      "width": 100
    },
    "shp_waybill_no": {
      "bsonType": "string",
      "title": "Waybill No",
      "description": "Waybill serial number",
      "placeholder": "Waybill No",
      "pattern": "^[A-Z0-9]{16,16}$",
      "minLength": 16,
      "maxLength": 16,
      "width": 140
    },
    "shp_carrier_name": {
      "bsonType": "string",
      "title": "Carrier",
      "description": "Carrier name or driver name surname",
      "placeholder": "Carrier or Driver Name",
      "minLength": 2,
      "maxLength": 32,
      "width": 180
    },
    "shp_carrier_id": {
      "bsonType": "string",
      "title": "Carrier Tax",
      "description": "Carrier tax no or driver id",
      "placeholder": "Carrier Tax/Id No",
      "minLength": 10,
      "maxLength": 12,
      "pattern": "^[0-9]{10,12}$",
      "width": 140
    },
    "shp_vehicle_id": {
      "bsonType": "string",
      "title": "vehicle Id",
      "description": "Vehicle plate number",
      "placeholder": "Vehicle Plate",
      "minLength": 6,
      "maxLength": 16,
      "pattern": "^[A-Za-z0-9 ]{6,16}$",
      "width": 140
    },
    "shp_status": {
      "bsonType": "string",
      "title": "Status",
      "description": "Status",
      "minLength": 2,
      "maxLength": 16,
      "pattern": "^[a-zA-Z]{2,16}$",
      "permanent": false,
      "enum": ["OK", "Processing", "Error"],
      "default": "Processing",
      "width": 100
    },
    "shp_notes": {
      "bsonType": "string",
      "title": "Notes",
      "description": "Shipment notes to carrier or customer",
      "placeholder": "Shipment Notes",
      "minLength": 0,
      "maxLength": 512,
      "width": 200
    }
  },
  "required": ["shp_id", "shp_carrier_name", "shp_carrier_id", "shp_date", "shp_waybill_no", "shp_vehicle_id"],
  "index": [["shp_id"], ["shp_waybill_no"]],
  "unique": [["shp_id"], ["shp_waybill_no"]],
  "parents": [],
  "links": [
    {
      "collection": "delivery",
      "get": "dnn_no",
      "set": [
        {
          "key": "dnn_waybill_no",
          "value": "shp_waybill_no"
        },
        {
          "key": "dnn_waybill_date",
          "value": "shp_date"
        }
      ]
    }
  ],
  "actions": [],
  "triggers": [],
  "views": {},
  "sort": {
    "_modified_at": -1
  },
  "connectors": [
    {
      "id": "shipment-connector",
      "enabled": true,
      "operations": ["update", "insert"],
      "method": "post",
      "url": "https://api.bi.technoplatz.com",
      "headers": [{ "Authorization": "$POST01_BEARER" }, { "X-Api-Key": "$POST01_APIKEY" }],
      "filter": [{}],
      "body": {
        "op": "upsert",
        "collection": "delivery",
        "data": {
          "DeliveryNo": "$dnn_no"
        }
      },
      "actions": {
        "200": {
          "mapping": [
            {
              "merchandise": [{ "source_field": "DeliveryNo", "target_field": "dnn_no" }]
            }
          ]
        }
      }
    }
  ]
}
