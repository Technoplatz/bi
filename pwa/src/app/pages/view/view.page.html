<!--
Technoplatz BI

Copyright (C) 2019-2023 Technoplatz IT Solutions GmbH, Mustafa Mat

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see https://www.gnu.org/licenses.

If your software can interact with users remotely through a computer
network, you should also make sure that it provides a way for users to
get its source.  For example, if your program is a web application, its
interface could display a "Source" link that leads users to an archive
of the code.  There are many ways you could offer source, and different
solutions will be better for different programs; see section 13 for the
specific requirements.

You should also get your employer (if you work as a programmer) or school,
if any, to sign a "copyright disclaimer" for the program, if necessary.
For more information on this, and how to apply and follow the GNU AGPL, see
https://www.gnu.org/licenses.
-->

<ion-content class="ion-no-padding" id="main-content">
  <ion-header class="app-header ion-no-border ion-no-margin">
    <ion-toolbar>
        <ion-buttons slot="start">
          <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title slot="start" class="ion-no-padding">
          {{ header }}
        </ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-grid *ngIf="is_initialized" class="ion-no-padding">
    <ion-row>
      <ion-col class="console-right-side">
        <ion-grid class="ion-no-padding ion-no-border">
          <ion-row>
            <ion-col class="console-right-0">
              <ion-grid class="ion-no-padding ion-margin-top ion-margin-bottom">
                <ion-row class="sub-menu-row sq-menu-row">
                  <ion-col size="12">
                    <div (click)="doAnnounceNow(view, 'test')" class="data-sq-button">
                      <ion-icon *ngIf="!in_otp_process_test" name="megaphone-outline"></ion-icon>
                      <ion-icon *ngIf="in_otp_process_test" name="hourglass-outline"></ion-icon>
                      <br />
                      <span>{{ 'Share' | translate }}<br />{{ 'TEST' | translate }}</span>
                    </div>
                    <div (click)="doAnnounceNow(view, 'live')" class="data-sq-button">
                      <ion-icon *ngIf="!in_otp_process" name="megaphone"></ion-icon>
                      <ion-icon *ngIf="in_otp_process" name="hourglass-outline"></ion-icon>
                      <br />
                      <span>{{ 'Share' | translate }}<br />{{ 'LIVE' | translate }}</span>
                    </div>
                    <div (click)="doCopy('view')" class="data-sq-button">
                      <ion-icon *ngIf="!is_url_copied" name="copy-outline"></ion-icon>
                      <ion-icon *ngIf="is_url_copied" name="checkmark-outline"></ion-icon>
                      <br />
                      <span *ngIf="!is_url_copied">{{ 'Copy' | translate }}<br />{{ 'Data Url' | translate
                        }}</span>
                      <span *ngIf="is_url_copied">{{ 'Data Url' | translate }}<br />{{ 'Copied' | translate
                        }}</span>
                    </div>
                    <div *ngIf="perm" (click)="Settings()" class="data-sq-button">
                      <ion-icon name="settings-outline"></ion-icon><br />
                      <span>{{ 'View Settings' | translate }}</span>
                    </div>
                  </ion-col>
                </ion-row>
              </ion-grid>

              <!-- VIEW GRID SECTION -->
              <div class="ion-margin-bottom">
                {{ 'Shared with' | translate }} {{ view["_tags"] && view["_tags"].join(' ') }}<br />
                <span *ngIf="view.vie_scheduled; else notscheduled">{{ 'Scheduled' | translate
                  }}</span>
                <ng-template #notscheduled>
                  {{ 'Not Scheduled' | translate }}
                </ng-template>
                <ion-grid class="data-grid ion-no-padding ion-margin-top">
                  <ion-row class="ion-nowrap">
                    <ion-col *ngFor="let item of view_properties_"
                      [style]="'min-width: ' + view_properties[item].width + 'px !important;'">
                      <span class="column-title">{{ view_properties[item].title }}<br />
                      </span>
                      {{ item }}
                    </ion-col>
                  </ion-row>
                  <ion-row *ngFor="let record of view_data; let i = index" class="ion-nowrap">
                    <ion-col *ngFor="let item of view_properties_"
                      [style]="'min-width: ' + view_properties[item].width + 'px !important;'">
                      {{ record[item] }}
                    </ion-col>
                  </ion-row>
                  <ion-row *ngIf="view_data && view_data.length==0" class="ion-nowrap">
                    <ion-col size="12" class="ion-no-padding">
                      {{ 'No data found' | translate }}
                    </ion-col>
                  </ion-row>
                  <ion-row></ion-row>
                  <ion-row *ngIf="view_count > 0" class="ion-nowrap">
                    <ion-col size="12" class="ion-no-padding">
                      {{ view_data.length }} {{ 'of' | translate }} {{ view_count }} {{ 'rows displayed' |
                      translate
                      }}.
                    </ion-col>
                  </ion-row>
                </ion-grid>
                <div [innerHtml]="pivot_" class="pivot"></div>
                <table *ngIf="statistics_" class="stat">
                  <tr>
                    <th colspan="8">
                      {{ 'DESCRIPTIVE STATISTICS' | translate }}<br />{{ statistics_key_ }}
                    </th>
                  </tr>
                  <tr>
                    <th>
                      <span>{{ 'Records' | translate }}<br />{{ 'Count' | translate }}</span>
                    </th>
                    <th>
                      <span>{{ 'Aritmetic Mean' | translate }}<br /></span>
                      [{{ 'numeric' | translate }}]
                    </th>
                    <th>
                      <span>{{ 'Standart Deviation' | translate }}<br /></span>
                      [{{ 'numeric' | translate }}]
                    </th>
                    <th>
                      <span>{{ 'Minimum' | translate }}<br /></span>
                      [{{ 'numeric' | translate }}]
                    </th>
                    <th>
                      <span>{{ 'Maximum' | translate }}<br /></span>
                      [{{ 'numeric' | translate }}]
                    </th>
                    <th>
                      <span>{{ 'Top' | translate }}<br /></span>
                      [{{ 'string' | translate }}]
                    </th>
                    <th>
                      <span>{{ 'Unique' | translate }}<br /></span>
                      [{{ 'string' | translate }}]
                    </th>
                    <th>
                      <span>{{ 'Frequency' | translate }}<br /></span>
                      [{{ 'string' | translate }}]
                    </th>
                  </tr>
                  <tr>
                    <td>
                      {{ statistics_.count}}
                    </td>
                    <td>
                      {{ statistics_.mean}}
                    </td>
                    <td>
                      {{ statistics_.std}}
                    </td>
                    <td>
                      {{ statistics_.min}}
                    </td>
                    <td>
                      {{ statistics_.max}}
                    </td>
                    <td>
                      {{ statistics_.top}}
                    </td>
                    <td>
                      {{ statistics_.unique}}
                    </td>
                    <td>
                      {{ statistics_.freq}}
                    </td>
                  </tr>
                </table>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
<app-inner-footer></app-inner-footer>